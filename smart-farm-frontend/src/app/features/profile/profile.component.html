<div class="profile-container">
  <div class="profile-header">
    <h1>Profile Settings</h1>
    <p>Manage your account information and preferences</p>
  </div>

  <div class="profile-content">
    <mat-tab-group>
      <!-- Profile Information Tab -->
      <mat-tab label="Profile Information">
        <div class="tab-content">
          <mat-card>
            <mat-card-header>
              <mat-card-title>
                <mat-icon>person</mat-icon>
                Personal Information
              </mat-card-title>
              <mat-card-subtitle>Update your personal details</mat-card-subtitle>
            </mat-card-header>
            <mat-card-content>
              <form [formGroup]="profileForm" (ngSubmit)="onProfileSubmit()" class="profile-form">
                <div class="form-row">
                  <mat-form-field appearance="outline" class="half-width">
                    <mat-label>First Name</mat-label>
                    <input matInput formControlName="first_name" placeholder="Enter your first name">
                    <mat-icon matSuffix>person</mat-icon>
                    <mat-error *ngIf="profileForm.get('first_name')?.invalid && profileForm.get('first_name')?.touched">
                      {{ getErrorMessage(profileForm, 'first_name') }}
                    </mat-error>
                  </mat-form-field>

                  <mat-form-field appearance="outline" class="half-width">
                    <mat-label>Last Name</mat-label>
                    <input matInput formControlName="last_name" placeholder="Enter your last name">
                    <mat-icon matSuffix>person</mat-icon>
                    <mat-error *ngIf="profileForm.get('last_name')?.invalid && profileForm.get('last_name')?.touched">
                      {{ getErrorMessage(profileForm, 'last_name') }}
                    </mat-error>
                  </mat-form-field>
                </div>

                <mat-form-field appearance="outline" class="full-width">
                  <mat-label>Email</mat-label>
                  <input matInput type="email" formControlName="email" placeholder="Enter your email">
                  <mat-icon matSuffix>email</mat-icon>
                  <mat-error *ngIf="profileForm.get('email')?.invalid && profileForm.get('email')?.touched">
                    {{ getErrorMessage(profileForm, 'email') }}
                  </mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width">
                  <mat-label>Phone</mat-label>
                  <input matInput type="tel" formControlName="phone" placeholder="Enter your phone number">
                  <mat-icon matSuffix>phone</mat-icon>
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width">
                  <mat-label>Address</mat-label>
                  <textarea matInput formControlName="address" placeholder="Enter your address" rows="3"></textarea>
                  <mat-icon matSuffix>location_on</mat-icon>
                </mat-form-field>

                <div class="form-row">
                  <mat-form-field appearance="outline" class="half-width">
                    <mat-label>City</mat-label>
                    <input matInput formControlName="city" placeholder="Enter your city">
                    <mat-icon matSuffix>location_city</mat-icon>
                  </mat-form-field>

                  <mat-form-field appearance="outline" class="half-width">
                    <mat-label>Country</mat-label>
                    <input matInput formControlName="country" placeholder="Enter your country">
                    <mat-icon matSuffix>public</mat-icon>
                  </mat-form-field>
                </div>

                <div class="form-row">
                  <mat-form-field appearance="outline" class="half-width">
                    <mat-label>Date of Birth</mat-label>
                    <input matInput type="date" formControlName="date_of_birth">
                    <mat-icon matSuffix>event</mat-icon>
                  </mat-form-field>

                  <mat-form-field appearance="outline" class="half-width">
                    <mat-label>Gender</mat-label>
                    <input matInput formControlName="gender" placeholder="Enter your gender">
                    <mat-icon matSuffix>person</mat-icon>
                  </mat-form-field>
                </div>

                <button mat-raised-button color="primary" type="submit" class="save-button" [disabled]="isLoading">
                  <mat-spinner *ngIf="isLoading" diameter="20" class="button-spinner"></mat-spinner>
                  <span *ngIf="!isLoading">Save Changes</span>
                </button>
              </form>
            </mat-card-content>
          </mat-card>
        </div>
      </mat-tab>

      <!-- Change Password Tab -->
      <mat-tab label="Change Password">
        <div class="tab-content">
          <mat-card>
            <mat-card-header>
              <mat-card-title>
                <mat-icon>lock</mat-icon>
                Change Password
              </mat-card-title>
              <mat-card-subtitle>Update your account password</mat-card-subtitle>
            </mat-card-header>
            <mat-card-content>
              <form [formGroup]="passwordForm" (ngSubmit)="onPasswordSubmit()" class="password-form">
                <mat-form-field appearance="outline" class="full-width">
                  <mat-label>Current Password</mat-label>
                  <input matInput [type]="hidePassword ? 'password' : 'text'" formControlName="currentPassword" placeholder="Enter your current password">
                  <button mat-icon-button matSuffix type="button" (click)="hidePassword = !hidePassword" [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hidePassword">
                    <mat-icon>{{hidePassword ? 'visibility_off' : 'visibility'}}</mat-icon>
                  </button>
                  <mat-error *ngIf="passwordForm.get('currentPassword')?.invalid && passwordForm.get('currentPassword')?.touched">
                    {{ getErrorMessage(passwordForm, 'currentPassword') }}
                  </mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width">
                  <mat-label>New Password</mat-label>
                  <input matInput [type]="hideNewPassword ? 'password' : 'text'" formControlName="newPassword" placeholder="Enter your new password">
                  <button mat-icon-button matSuffix type="button" (click)="hideNewPassword = !hideNewPassword" [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hideNewPassword">
                    <mat-icon>{{hideNewPassword ? 'visibility_off' : 'visibility'}}</mat-icon>
                  </button>
                  <mat-error *ngIf="passwordForm.get('newPassword')?.invalid && passwordForm.get('newPassword')?.touched">
                    {{ getErrorMessage(passwordForm, 'newPassword') }}
                  </mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width">
                  <mat-label>Confirm New Password</mat-label>
                  <input matInput [type]="hideConfirmPassword ? 'password' : 'text'" formControlName="confirmPassword" placeholder="Confirm your new password">
                  <button mat-icon-button matSuffix type="button" (click)="hideConfirmPassword = !hideConfirmPassword" [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hideConfirmPassword">
                    <mat-icon>{{hideConfirmPassword ? 'visibility_off' : 'visibility'}}</mat-icon>
                  </button>
                  <mat-error *ngIf="passwordForm.get('confirmPassword')?.invalid && passwordForm.get('confirmPassword')?.touched">
                    {{ getErrorMessage(passwordForm, 'confirmPassword') }}
                  </mat-error>
                </mat-form-field>

                <button mat-raised-button color="primary" type="submit" class="save-button" [disabled]="isPasswordLoading">
                  <mat-spinner *ngIf="isPasswordLoading" diameter="20" class="button-spinner"></mat-spinner>
                  <span *ngIf="!isPasswordLoading">Update Password</span>
                </button>
              </form>
            </mat-card-content>
          </mat-card>
        </div>
      </mat-tab>

      <!-- Account Information Tab -->
      <mat-tab label="Account Information">
        <div class="tab-content">
          <mat-card>
            <mat-card-header>
              <mat-card-title>
                <mat-icon>info</mat-icon>
                Account Details
              </mat-card-title>
              <mat-card-subtitle>View your account information</mat-card-subtitle>
            </mat-card-header>
            <mat-card-content>
              <div class="account-info" *ngIf="user()">
                <div class="info-item">
                  <mat-icon>badge</mat-icon>
                  <div class="info-content">
                    <span class="info-label">User ID</span>
                    <span class="info-value">{{ user()?.user_id }}</span>
                  </div>
                </div>
                
                <div class="info-item">
                  <mat-icon>work</mat-icon>
                  <div class="info-content">
                    <span class="info-label">Role</span>
                    <span class="info-value">{{ user()?.role | titlecase }}</span>
                  </div>
                </div>
                
                <div class="info-item">
                  <mat-icon>check_circle</mat-icon>
                  <div class="info-content">
                    <span class="info-label">Status</span>
                    <span class="info-value">{{ user()?.status | titlecase }}</span>
                  </div>
                </div>
                
                <div class="info-item">
                  <mat-icon>schedule</mat-icon>
                  <div class="info-content">
                    <span class="info-label">Member Since</span>
                    <span class="info-value">{{ user()?.created_at | date:'medium' }}</span>
                  </div>
                </div>
                
                <div class="info-item" *ngIf="user()?.last_login">
                  <mat-icon>login</mat-icon>
                  <div class="info-content">
                    <span class="info-label">Last Login</span>
                    <span class="info-value">{{ user()?.last_login | date:'medium' }}</span>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>
        </div>
      </mat-tab>
    </mat-tab-group>
  </div>
</div>
